% File 'bw-serializable-test'
% Two queries in the blocks world with blocks a,b,c,d

:- include 'bw-serializable'.

:- objects
  a,b,c,d                    :: block.

:- nmquery

% Find the result of moving block a to the table in the state
%
%    a   c   
%    b   d   
%  --------- 

 label   :: 1;
 maxstep :: 1;

 anyFluentValues;
 constraint 0:
  loc(a)=b,
  loc(b)=table,
  loc(c)=d,
  loc(d)=table;

 cwaActions;
 0:move(a);
 0:destination(a)=table.



:- nmquery

% Find a 2-step plan:
%
% initial condition       goal
%
%    a   c                b   d    
%    b   d                a   c
%  ---------            ---------

 label   :: 2;
 maxstep :: 2;

 anyHistory;
 constraint 0:
  loc(a)=b,
  loc(b)=table,
  loc(c)=d,
  loc(d)=table;
 constraint maxstep:
  loc(a)=table,
  loc(b)=a,
  loc(c)=table,
  loc(d)=c.

/*
| ?- loadf 'bw-serializable-test'.
% loading file /stage/projects3/tag/ccalc/macros.std
% loading file /stage/projects3/tag/ccalc/examples/bw-serializable-test
% loading file /stage/projects3/tag/ccalc/examples/bw-serializable
% in transition mode...
% 68 atoms, 280 rules, 364 clauses
% Grounding time: 0.49 seconds
% Completion time: 0.1 seconds
yes
| ?- nmquery 1.
% Shifted theory: 68 atoms (incl. auxiliary atoms), 364 clauses, 0.16 seconds
% Calling mChaff... 
% Solution time: 0.02 seconds (prep 0.02 seconds, search 0 seconds)  

0:  loc(a)=b  loc(b)=table  loc(c)=d  loc(d)=table 

ACTIONS:  move(a,destination:table)  

1:  loc(a)=table  loc(b)=table  loc(c)=d  loc(d)=table 
yes
| ?- nmquery 2.
% Shifted theory: 116 atoms (incl. auxiliary atoms), 660 clauses, 0.35 seconds
% Calling mChaff... 
% Solution time: 0.02 seconds (prep 0.01 seconds, search 0.01 seconds)  

0:  loc(a)=b  loc(b)=table  loc(c)=d  loc(d)=table 

ACTIONS:  move(a,destination:table)  move(c,destination:table)  

1:  loc(a)=table  loc(b)=table  loc(c)=table  loc(d)=table 

ACTIONS:  move(b,destination:a)  move(d,destination:c)  

2:  loc(a)=table  loc(b)=a  loc(c)=table  loc(d)=c 
yes
| ?- 
*/
